
/**********************************************************************************************************************
 * \file    yawAngle.c
 * \brief
 * \version V1.0.0
 * \date    2022年6月29日
 * \author  McDuck
 *********************************************************************************************************************/



/*********************************************************************************************************************/
/*-----------------------------------------------------Includes------------------------------------------------------*/
/*********************************************************************************************************************/
#include "yawAngle.h"
/*********************************************************************************************************************/
/*-------------------------------------------------Global variables--------------------------------------------------*/
/*********************************************************************************************************************/
boolean angle_int_flag = 0;
float angle = 0.0;
extern float gyro[3];
/*********************************************************************************************************************/
/*--------------------------------------------Private Variables/Constants--------------------------------------------*/
/*********************************************************************************************************************/

/*********************************************************************************************************************/
/*------------------------------------------------Function Prototypes------------------------------------------------*/
/*********************************************************************************************************************/

/*********************************************************************************************************************/
/*---------------------------------------------Function Implementations----------------------------------------------*/
/*********************************************************************************************************************/
/**
* @brief    开始积分角度
* @return   void
*/
void start_integrating_angle(void){
    angle_int_flag = 1;
}
/**
* @brief    欧拉法积分角度，置于中断中
* @param    dt  采样时间间隔
* @return   void
*/
void interat_yaw_angle(float dt){
    if(angle_int_flag)
    {
        get_icm20602_gyro();
        angle += gyro[2]*dt;
    }
}
/**
* @brief    查询积分角度
* @return   当前积分角度
*/
IFX_INLINE static float check_yaw_angle(void){
    return angle;
}
/**
* @brief    停止积分角度，并清空角度值
* @return   void
*/
void stop_interating_angle(void){
    angle_int_flag = 0;
    angle = 0;
}

IFX_INLINE static uint8 is_interating_angle(void){
    return angle_int_flag;
}
