
/**********************************************************************************************************************
 * \file    KF.c
 * \brief
 * \version V1.0.0
 * \date    2022Äê6ÔÂ24ÈÕ
 * \author  McDuck
 *********************************************************************************************************************/



/*********************************************************************************************************************/
/*-----------------------------------------------------Includes------------------------------------------------------*/
/*********************************************************************************************************************/
#include "KF.h"
/*********************************************************************************************************************/
/*-------------------------------------------------Global variables--------------------------------------------------*/
/*********************************************************************************************************************/
 kalman_filter accX={.eMea = 0.01, .eEst = 0.01, .lEst =0.1, .Kk = 1, .cEst = 0};
 kalman_filter accY={.eMea = 0.01, .eEst = 100, .lEst =0};
 kalman_filter accZ={.eMea = 0.01, .eEst = 100, .lEst =0};
 kalman_filter gyroX={.eMea = 0.01, .eEst = 100, .lEst =0};
 kalman_filter gyroY={.eMea = 0.01, .eEst = 100, .lEst =0};
 kalman_filter gyroZ={.eMea = 0.01, .eEst = 100, .lEst =0};

 float position[3];

/*********************************************************************************************************************/
/*--------------------------------------------Private Variables/Constants--------------------------------------------*/
/*********************************************************************************************************************/

/*********************************************************************************************************************/
/*------------------------------------------------Function Prototypes------------------------------------------------*/
/*********************************************************************************************************************/

/*********************************************************************************************************************/
/*---------------------------------------------Function Implementations----------------------------------------------*/
/*********************************************************************************************************************/

float KF(float mData, kalman_filter* kf){
    kf->Kk = kf->eEst/(kf->eEst + kf->eMea);
    kf->cEst = kf->cEst + kf->Kk*(mData - kf->cEst);
    kf->eEst = (1-kf->Kk)*kf->eEst;
    return kf->cEst;
}

